"use strict";
/**
 * Unit tests for signable/orders.ts.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const big_js_1 = __importDefault(require("big.js"));
const expect_1 = __importDefault(require("expect"));
const lodash_1 = __importDefault(require("lodash"));
const types_1 = require("../../src/types");
const keys_1 = require("../../src/keys");
const helpers_1 = require("../../src/helpers");
const util_1 = require("../util");
// Module under test.
const order_1 = require("../../src/signable/order");
// Mock params.
const mockKeyPair = {
    publicKey: '3b865a18323b8d147a12c556bfb1d502516c325b1477a23ba6c77af31f020fd',
    privateKey: '58c7d5a90b1776bde86ebac077e053ed85b0f7164f53b080304a531947f46e3',
};
const mockKeyPairPublicYCoordinate = ('211496e5e8ccf71930aebbfb7e815807acbfd0021f17f8b3944a3ed5f06c27');
const mockKeyPairEvenY = {
    publicKey: '5c749cd4c44bdc730bc90af9bfbdede9deb2c1c96c05806ce1bc1cb4fed64f7',
    privateKey: '65b7bb244e019b45a521ef990fb8a002f76695d1fc6c1e31911680f2ed78b84',
};
const mockOrder = {
    positionId: '12345',
    humanSize: '145.0005',
    limitFee: '0.125',
    market: types_1.DydxMarket.ETH_USD,
    side: types_1.StarkwareOrderSide.BUY,
    expirationIsoTimestamp: '2020-09-17T04:15:55.028Z',
    humanPrice: '350.00067',
    clientId: 'This is an ID that the client came up with to describe this order',
};
const mockSignature = ('00cecbe513ecdbf782cd02b2a5efb03e58d5f63d15f2b840e9bc0029af04e8dd' +
    '0090b822b16f50b2120e4ea9852b340f7936ff6069d02acca02f2ed03029ace5');
const mockSignatureEvenY = ('00fc0756522d78bef51f70e3981dc4d1e82273f59cdac6bc31c5776baabae6ec' +
    '0158963bfd45d88a99fb2d6d72c9bbcf90b24c3c0ef2394ad8d05f9d3983443a');
describe('SignableOrder', () => {
    describe('verifySignature()', () => {
        it('returns true for a valid signature (odd y)', async () => {
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(mockSignature, mockKeyPair.publicKey);
            (0, expect_1.default)(result).toBe(true);
        });
        it('returns true for a valid signature (odd y), with y-coordinate provided', async () => {
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(mockSignature, mockKeyPair.publicKey, mockKeyPairPublicYCoordinate);
            (0, expect_1.default)(result).toBe(true);
        });
        it('returns true for a valid signature (even y)', async () => {
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(mockSignatureEvenY, mockKeyPairEvenY.publicKey);
            (0, expect_1.default)(result).toBe(true);
        });
        it('returns false for an invalid signature', async () => {
            // Mutate a single character in r.
            await Promise.all(lodash_1.default.range(1, 4).map(async (i) => {
                const badSignature = (0, util_1.mutateHexStringAt)(mockSignature, i);
                const result = await order_1.SignableOrder
                    .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                    .verifySignature(badSignature, mockKeyPair.publicKey);
                (0, expect_1.default)(result).toBe(false);
            }));
            // Mutate a single character in s.
            await Promise.all(lodash_1.default.range(1, 4).map(async (i) => {
                const badSignature = (0, util_1.mutateHexStringAt)(mockSignature, i + 64);
                const result = await order_1.SignableOrder
                    .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                    .verifySignature(badSignature, mockKeyPair.publicKey);
                (0, expect_1.default)(result).toBe(false);
            }));
        });
        it('returns false for a invalid signature (odd y), with y-coordinate provided', async () => {
            const badSignature = (0, util_1.mutateHexStringAt)(mockSignature, 1);
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(badSignature, mockKeyPair.publicKey, mockKeyPairPublicYCoordinate);
            (0, expect_1.default)(result).toBe(false);
        });
        it('returns false if the x-coordinate is invalid, when y-coordinate is provided', async () => {
            const badX = (0, util_1.mutateHexStringAt)(mockKeyPair.publicKey, 20); // Arbitrary offset.
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(mockSignature, badX, mockKeyPairPublicYCoordinate);
            (0, expect_1.default)(result).toBe(false);
        });
        it('returns false if the y-coordinate is invalid', async () => {
            const badY = (0, util_1.mutateHexStringAt)(mockKeyPairPublicYCoordinate, 20); // Arbitrary offset.
            const result = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .verifySignature(mockSignature, mockKeyPair.publicKey, badY);
            (0, expect_1.default)(result).toBe(false);
        });
    });
    describe('sign()', () => {
        it('signs an order (odd y)', async () => {
            const signature = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).toEqual(mockSignature);
        });
        it('signs an order (even y)', async () => {
            const signature = await order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPairEvenY.privateKey);
            (0, expect_1.default)(signature).toEqual(mockSignatureEvenY);
        });
        it('signs an order with quoteAmount instead of price', async () => {
            const roundedQuoteAmount = new big_js_1.default(mockOrder.humanSize)
                .times(mockOrder.humanPrice)
                .round(6, 3 /* RoundUp */)
                .toFixed();
            const orderWithQuoteAmount = {
                ...mockOrder,
                humanPrice: undefined,
                humanQuoteAmount: roundedQuoteAmount,
            };
            const signature = await order_1.SignableOrder
                .fromOrder(orderWithQuoteAmount, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).toEqual(mockSignature);
        });
        it('signs an order with nonce instead of clientId', async () => {
            const orderWithNonce = {
                ...mockOrder,
                clientId: undefined,
                nonce: (0, helpers_1.nonceFromClientId)(mockOrder.clientId),
            };
            const signature = await order_1.SignableOrder
                .fromOrderWithNonce(orderWithNonce, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).toEqual(mockSignature);
        });
        it('generates a different signature when the client ID is different', async () => {
            const order = {
                ...mockOrder,
                clientId: `${mockOrder.clientId}!`,
            };
            const signature = await order_1.SignableOrder
                .fromOrder(order, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).not.toEqual(mockSignature);
        });
        it('generates a different signature for a SELL order', async () => {
            const order = {
                ...mockOrder,
                side: types_1.StarkwareOrderSide.SELL,
            };
            const signature = await order_1.SignableOrder
                .fromOrder(order, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).not.toEqual(mockSignature);
        });
        it('generates a different signature when the position ID is different', async () => {
            const order = {
                ...mockOrder,
                positionId: (Number.parseInt(mockOrder.positionId, 10) + 1).toString(),
            };
            const signature = await order_1.SignableOrder
                .fromOrder(order, types_1.NetworkId.ROPSTEN)
                .sign(mockKeyPair.privateKey);
            (0, expect_1.default)(signature).not.toEqual(mockSignature);
        });
    });
    describe('toStarkware()', () => {
        it('converts human amounts to quantum amounts and converts expiration to hours', () => {
            const starkwareOrder = order_1.SignableOrder
                .fromOrder(mockOrder, types_1.NetworkId.ROPSTEN)
                .toStarkware();
            (0, expect_1.default)(starkwareOrder.quantumsAmountSynthetic).toBe('145000500000');
            (0, expect_1.default)(starkwareOrder.quantumsAmountCollateral).toBe('50750272151');
            (0, expect_1.default)(starkwareOrder.quantumsAmountFee).toBe('6343784019');
            // Order expiration should be rounded up, and should have a buffer added.
            (0, expect_1.default)(starkwareOrder.expirationEpochHours).toBe(444701);
        });
        it('throws if the market is unknown', () => {
            const order = {
                ...mockOrder,
                market: 'FAKE-MARKET',
            };
            (0, expect_1.default)(() => order_1.SignableOrder.fromOrder(order, types_1.NetworkId.ROPSTEN).toStarkware()).toThrow('Unknown market');
        });
        it('correctly handles an expiration close to the start of the hour', () => {
            const order = {
                ...mockOrder,
                expirationIsoTimestamp: '2021-02-24T16:00:00.407Z',
            };
            const starkwareOrder = order_1.SignableOrder.fromOrder(order, types_1.NetworkId.ROPSTEN).toStarkware();
            (0, expect_1.default)(starkwareOrder.expirationEpochHours).toBe(448553);
        });
    });
    it('end-to-end', async () => {
        // Repeat some number of times.
        await Promise.all(lodash_1.default.range(3).map(async () => {
            const keyPair = (0, keys_1.generateKeyPairUnsafe)();
            const signableOrder = order_1.SignableOrder.fromOrder(mockOrder, types_1.NetworkId.ROPSTEN);
            const signature = await signableOrder.sign(keyPair.privateKey);
            // Expect to be valid when verifying with the right public key.
            (0, expect_1.default)(await signableOrder.verifySignature(signature, keyPair.publicKey)).toBe(true);
            // Expect to be invalid when verifying with a different public key.
            (0, expect_1.default)(await signableOrder.verifySignature(signature, mockKeyPair.publicKey)).toBe(false);
        }));
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3JkZXIudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL19fdGVzdHNfXy9zaWduYWJsZS9vcmRlci50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7Ozs7QUFFSCxvREFBMkM7QUFDM0Msb0RBQTRCO0FBQzVCLG9EQUF1QjtBQUV2QiwyQ0FTeUI7QUFDekIseUNBQXVEO0FBQ3ZELCtDQUFzRDtBQUN0RCxrQ0FBNEM7QUFFNUMscUJBQXFCO0FBQ3JCLG9EQUF5RDtBQUV6RCxlQUFlO0FBQ2YsTUFBTSxXQUFXLEdBQVk7SUFDM0IsU0FBUyxFQUFFLGlFQUFpRTtJQUM1RSxVQUFVLEVBQUUsaUVBQWlFO0NBQzlFLENBQUM7QUFDRixNQUFNLDRCQUE0QixHQUFHLENBQ25DLGdFQUFnRSxDQUNqRSxDQUFDO0FBQ0YsTUFBTSxnQkFBZ0IsR0FBWTtJQUNoQyxTQUFTLEVBQUUsaUVBQWlFO0lBQzVFLFVBQVUsRUFBRSxpRUFBaUU7Q0FDOUUsQ0FBQztBQUNGLE1BQU0sU0FBUyxHQUFzQjtJQUNuQyxVQUFVLEVBQUUsT0FBTztJQUNuQixTQUFTLEVBQUUsVUFBVTtJQUNyQixRQUFRLEVBQUUsT0FBTztJQUNqQixNQUFNLEVBQUUsa0JBQVUsQ0FBQyxPQUFPO0lBQzFCLElBQUksRUFBRSwwQkFBa0IsQ0FBQyxHQUFHO0lBQzVCLHNCQUFzQixFQUFFLDBCQUEwQjtJQUNsRCxVQUFVLEVBQUUsV0FBVztJQUN2QixRQUFRLEVBQUUsbUVBQW1FO0NBQzlFLENBQUM7QUFDRixNQUFNLGFBQWEsR0FBRyxDQUNwQixrRUFBa0U7SUFDbEUsa0VBQWtFLENBQ25FLENBQUM7QUFDRixNQUFNLGtCQUFrQixHQUFHLENBQ3pCLGtFQUFrRTtJQUNsRSxrRUFBa0UsQ0FDbkUsQ0FBQztBQUVGLFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO0lBRTdCLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFFakMs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